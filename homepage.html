<!DOCTYPE html>
<html>
        <head>
                <title>homepage</title>
                <link rel="stylesheet" type="text/css" href="elements.css?v=123">
        </head>
        <body>
		<div class="top-panel">
		<h1>welcome</h1>
		<form id="search-bar">
			<div class="form-group1">
				<input type="text" placeholder="Search products" id="searched-product">
			</div>

			<input type="submit" class="button" id="search-button" value="Search">
		</form>
		</div>
		<div id="productDiv">
			<div id="product-image"></div>
		<h2 id='output'></h2>
		</div>
	</body>
	<script>
		document.getElementById('search-button').addEventListener('click', searchProduct);
		
		function searchProduct(e){
			e.preventDefault()
			const product = document.getElementById('searched-product').value;	
			const token = localStorage.getItem("access_token");
			const output = document.getElementById('output');
			fetch(`http://127.0.0.1:8000/searchproducts/${product}`, {
				method: 'GET',
				headers: {
					"Authorization": `Bearer ${token}`
				}
			})
			.then(res => {
                                return res.json().then(data => ({ status: res.status, data: data }));
                        })
                        .then(({ status, data }) => {
                                if (status === 200) {
					const productImage = document.getElementById('product-image');
					productImage.classList.add('productImage');
					const productDiv = document.getElementById('productDiv');
					productDiv.classList.add('product');
					output.innerHTML = `
						<ul>
							<li>${data.name}</li>
							<li>Price: ${data.price}</li>
						</ul>

					`;
				} else {
 					window.location.reload()
					output.innerHTML = data.detail;
                                        setTimeout(() => output.remove(), 5000);

				}
			});
		}

	</script>
</html>

