<!DOCTYPE html>
<html>
        <head>
                <title>sign up</title>
		<link rel="stylesheet" type="text/css" href="elements.css?v=123">
        </head>
        <body>
		<div class="container">
		<form id="signUp" class="form">
			<h2 class="title">Create account</h2>
			<h3 id="output"><h3>
			<div class="form-group">
				<input type="text" id="email" placeholder="Email">
			</div>

			<div class="form-group">
				<input type="text" id="username" placeholder="Username">
			</div>

			<div class="form-group">
				<input type="text" id="password" placeholder="Password">
			</div>

			<a id="adminButton" href="http://localhost:5500/adminsignup.html">Or signup as admin</a>

			<input id="post" type="submit" value="Sign up" class="button">
		</form>
		</div>
        </body>
        <script>
		document.getElementById('signUp').addEventListener("submit", signUp)
		const button = document.getElementById('post')
//so, we asign a signup function to the button, this func takes the information entered in the form inputs and makes a post request to my api, specifically by fetching the url of my signup route, declaring a post method with headers, then sending the data through the (body) thing, firstly turning it into json,
		function signUp(e) {
			e.preventDefault();
			let email = document.getElementById("email").value;
			let username = document.getElementById("username").value;
			let password = document.getElementById("password").value;
			
			const response = fetch("http://127.0.0.1:8000/signup", {
				method: 'post',
				headers: {
					'accept': 'application/json, text/plain, */*',
					'content-type': 'application/json'
				},
				body:JSON.stringify({email:email, username:username, password:password})
			}).then(res => {
				return res.json().then(data => ({ status: res.status, data: data }));
			})
			.then(({ status, data }) => {
				if (status === 200) {
					localStorage.setItem("access_token", data.access_token);
            				localStorage.setItem("refresh_token", data.refresh_token);
            				window.location.assign('http://localhost:5500/signin.html');
				} else {
					const output = document.getElementById('output');
            				output.innerHTML = data.detail;
            				setTimeout(() => output.remove(), 3000);
				}
			});

		}
        </script>
</html>
	
